<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Config Page</title>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      try {
        // Get the current 'tableid' from the URL of 'index.html' for reference
        const indexUrlParams = new URLSearchParams(window.location.search);
        const currentTableId = indexUrlParams.get("tableid") || "";

        // Pre-fill the input field with the current 'tableid'
        const tableIdInput = document.getElementById("tableid-input");
        tableIdInput.value = currentTableId;

        // Save button functionality
        document.getElementById("save-btn").addEventListener("click", () => {
          const newTableId = tableIdInput.value.trim();

          // Validate the new 'tableid'
          if (!newTableId) {
            document.getElementById("status-message").innerText = 
              "Error: Table ID cannot be empty!";
            document.getElementById("status-message").style.color = "red";
            return;
          }

          // Update the URL for 'index.html' with the new 'tableid'
          let newUrl = `index.html?tableid=${encodeURIComponent(newTableId)}`;
          const name = indexUrlParams.get("name");
          if (name) {
            newUrl += `&name=${encodeURIComponent(name)}`; // Preserve the 'name' if it exists
          }

          document.getElementById("status-message").innerText = 
            "Configuration saved! Redirecting...";
          document.getElementById("status-message").style.color = "green";

          // Redirect to the updated index page URL
          setTimeout(() => {
            window.location.href = newUrl;
          }, 1500);
        });
      } catch (error) {
        console.error("Error:", error);
        document.getElementById("status-message").innerText = 
          "An unexpected error occurred. Please try again later.";
        document.getElementById("status-message").style.color = "red";
      }
    });
  </script>
</head>
<body>
  <h1>Config Page</h1>
  <p>Update the table ID for the index page:</p>
  <label for="tableid-input">Table ID:</label>
  <input type="text" id="tableid-input" placeholder="Enter table ID" />
  <button id="save-btn">Save Changes</button>
  <p id="status-message"></p>
</body>
</html>
